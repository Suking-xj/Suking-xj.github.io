var e=Object.defineProperty,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(r,t,n)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[t]=n;import{aj as i}from"./vendor.74d5941c.js";import{s as a,a as s,o as p}from"./VertexArrayObject.67803418.js";import{r as c,o as d}from"./FramebufferObject.18518335.js";async function l(e){const r=new Image;if(r.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",r.width=5,r.height=5,await r.decode(),!e.gl)return!0;const t=new c(e,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),n=a.createVertex(e,35044,new Uint16Array([0,0,1,0,0,1,1,1])),o=new s(e,{a_pos:0},{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:n}),i=new p(e,"\n  precision highp float;\n\n  attribute vec2 a_pos;\n  varying vec2 v_uv;\n\n  void main() {\n    v_uv = a_pos;\n    gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ","\n  precision highp float;\n\n  varying vec2 v_uv;\n  uniform sampler2D u_texture;\n\n  void main() {\n    gl_FragColor = texture2D(u_texture, v_uv);\n  }\n  ",{a_pos:0});e.bindProgram(i);const l=new d(e,{dataType:5121,pixelFormat:6408,preMultiplyAlpha:!1,wrapMode:33071,samplingMode:9729},r);e.bindTexture(l,0),i.setUniform1i("u_texture",0);const g=e.getBoundFramebufferObject(),{x:m,y:u,width:f,height:v}=e.getViewport();e.bindFramebuffer(t),e.setViewport(0,0,1,1),e.bindVAO(o),e.drawArrays(5,0,4);const w=new Uint8Array(4);return t.readPixels(0,0,1,1,6408,5121,w),i.dispose(),o.dispose(!1),n.dispose(),t.dispose(),l.dispose(),e.setViewport(m,u,f,v),e.bindFramebuffer(g),r.src="",255===w[0]}async function g(e,a){const{data:s}=await i(e,((e,i)=>{for(var a in i||(i={}))t.call(i,a)&&o(e,a,i[a]);if(r)for(var a of r(i))n.call(i,a)&&o(e,a,i[a]);return e})({responseType:"image"},a));return s}export{l as n,g as t};
