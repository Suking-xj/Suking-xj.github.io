import{fg as n,fk as t,fh as r}from"./vendor.74d5941c.js";import{J as e,l as u,Z as i,F as a,E as c,aj as o,M as s}from"./arcadeUtils.f4f7c393.js";import{WhereClause as f}from"./WhereClause.f27c6004.js";import"./number.c0719e5d.js";import"./FeatureSetReader.a91e3e2d.js";import"./centroid.93c1b848.js";import"./_commonjsHelpers.f2a458db.js";function d(t,r,e,a,d,m){if(1===a.length){if(i(a[0]))return n(o(t,a[0],s(a[1],-1)));if(c(a[0]))return n(o(t,a[0].toArray(),s(a[1],-1)))}else if(2===a.length){if(i(a[0]))return n(o(t,a[0],s(a[1],-1)));if(c(a[0]))return n(o(t,a[0].toArray(),s(a[1],-1)));if(u(a[0]))return a[0].load().then((n=>l(f.create(a[1],n.getFieldsIndex()),m,d).then((n=>a[0].calculateStatistic(t,n,s(a[2],1e3),r.abortSignal)))))}else if(3===a.length&&u(a[0]))return a[0].load().then((n=>l(f.create(a[1],n.getFieldsIndex()),m,d).then((n=>a[0].calculateStatistic(t,n,s(a[2],1e3),r.abortSignal)))));return n(o(t,a,-1))}function l(e,u,i){try{const r=e.getVariables();if(r.length>0){const n=[];for(let t=0;t<r.length;t++){const e={name:r[t]};n.push(u.evaluateIdentifier(i,e))}return t(n).then((n=>{const t={};for(let e=0;e<r.length;e++)t[r[e]]=n[e];return e.parameters=t,e}))}return n(e)}catch(a){return r(a)}}function m(n){"async"===n.mode&&(n.functions.stdev=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("stdev",r,0,u,t,n)}))},n.functions.variance=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("variance",r,0,u,t,n)}))},n.functions.average=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("mean",r,0,u,t,n)}))},n.functions.mean=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("mean",r,0,u,t,n)}))},n.functions.sum=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("sum",r,0,u,t,n)}))},n.functions.min=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("min",r,0,u,t,n)}))},n.functions.max=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("max",r,0,u,t,n)}))},n.functions.count=function(t,r){return n.standardFunctionAsync(t,r,(function(n,t,r){if(e(r,1,1),u(r[0]))return r[0].count(n.abortSignal);if(i(r[0])||a(r[0]))return r[0].length;if(c(r[0]))return r[0].length();throw new Error("Invalid Parameters for Count")}))})}export{m as registerFunctions};
